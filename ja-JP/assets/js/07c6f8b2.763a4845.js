"use strict";(self.webpackChunkkirbee_website=self.webpackChunkkirbee_website||[]).push([[5049],{66077:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"AWS/Compute Service/Lambda","title":"Lambda","description":"Lambda:","source":"@site/docs/AWS/Compute Service/Lambda.md","sourceDirName":"AWS/Compute Service","slug":"/AWS/Compute Service/Lambda","permalink":"/kirbeee/ja-JP/docs/AWS/Compute Service/Lambda","draft":false,"unlisted":false,"editUrl":"https://github.com/kirbeee/kirbeee/docs/AWS/Compute Service/Lambda.md","tags":[{"inline":true,"label":"AWS","permalink":"/kirbeee/ja-JP/docs/tags/aws"}],"version":"current","lastUpdatedBy":"Sean","lastUpdatedAt":1742169600000,"frontMatter":{"title":"Lambda","author":"kirbee","tags":["AWS"],"last_update":{"date":"3/17/2025","author":"Sean"}},"sidebar":"docs","previous":{"title":"Fargate","permalink":"/kirbeee/ja-JP/docs/AWS/Compute Service/Container/Fargate"},"next":{"title":"Lightsail","permalink":"/kirbeee/ja-JP/docs/AWS/Compute Service/Lightsail"}}');var a=i(74848),r=i(28453);const t={title:"Lambda",author:"kirbee",tags:["AWS"],last_update:{date:"3/17/2025",author:"Sean"}},l="Lambda vs EC2",c={},o=[{value:"AWS Lambda Integrations Main Services",id:"aws-lambda-integrations-main-services",level:2},{value:"Example: Serverless Thumbnail Generation",id:"example-serverless-thumbnail-generation",level:2},{value:"Example: Serverless CRON Job",id:"example-serverless-cron-job",level:2},{value:"Lambda Concurrency and Throttling",id:"lambda-concurrency-and-throttling",level:2},{value:"Lambda Concurrency Issue",id:"lambda-concurrency-issue",level:3},{value:"Concurrency and Asynchronous Invocations",id:"concurrency-and-asynchronous-invocations",level:2},{value:"Cold Starts &amp; Provisioned Concurrency",id:"cold-starts--provisioned-concurrency",level:2},{value:"Reserved and Provisioned Concurrency",id:"reserved-and-provisioned-concurrency",level:2},{value:"Lambda SnapStart",id:"lambda-snapstart",level:2},{value:"Customization At The Edge",id:"customization-at-the-edge",level:2},{value:"CloudFront Functions &amp; Lambda@Edge Use Cases",id:"cloudfront-functions--lambdaedge-use-cases",level:3},{value:"Lambda by default",id:"lambda-by-default",level:2},{value:"Lambda in VPC",id:"lambda-in-vpc",level:2},{value:"Lambda with RDS Proxy",id:"lambda-with-rds-proxy",level:2},{value:"Invoking Lambda from RDS &amp; Aurora",id:"invoking-lambda-from-rds--aurora",level:2}];function d(e){const n={a:"a",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"lambda-vs-ec2",children:"Lambda vs EC2"})}),"\n",(0,a.jsx)(n.p,{children:"Lambda:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Virtual functions - no servers to manage!"}),"\n",(0,a.jsx)(n.li,{children:"Limited by time - short executions"}),"\n",(0,a.jsx)(n.li,{children:"Run on-demand"}),"\n",(0,a.jsx)(n.li,{children:"Scaling is automated!"}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.p,{children:"EC2:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Virtual Servers in the Cloud"}),"\n",(0,a.jsx)(n.li,{children:"Limited by RAM and CPU"}),"\n",(0,a.jsx)(n.li,{children:"Continuously running"}),"\n",(0,a.jsx)(n.li,{children:"Scaling means intervention to add / remove servers"}),"\n"]}),"\n",(0,a.jsx)(n.h1,{id:"benefits-of-lambda",children:"Benefits of Lambda"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Easy Pricing:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Pay per request and compute time"}),"\n",(0,a.jsx)(n.li,{children:"Free tier of 1,000,000 AWS Lambda requests and 400,000 GBs of compute time"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"Integrated with the whole AWS suite of services"}),"\n",(0,a.jsx)(n.li,{children:"Event-Driven: functions get invoked by AWS when needed"}),"\n",(0,a.jsx)(n.li,{children:"Integrated with many programming languages"}),"\n",(0,a.jsx)(n.li,{children:"Easy monitoring through AWS Cloud Watch"}),"\n",(0,a.jsx)(n.li,{children:"Easy to get more resources per functions (up to I0GB of RAM!)"}),"\n",(0,a.jsx)(n.li,{children:"Increasing RAM will also improve CPU and network!"}),"\n"]}),"\n",(0,a.jsx)(n.h1,{id:"aws-lambda-languages-supported",children:"AWS Lambda languages supported"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Node.js (JavaScript)"}),"\n",(0,a.jsx)(n.li,{children:"Python"}),"\n",(0,a.jsx)(n.li,{children:"Java"}),"\n",(0,a.jsx)(n.li,{children:"C# (NET Core) / Powershell"}),"\n",(0,a.jsx)(n.li,{children:"Ruby"}),"\n",(0,a.jsx)(n.li,{children:"Custom Runtime API (community supported, example Rust or Golang)"}),"\n",(0,a.jsx)(n.li,{children:"Lambda Container Image"}),"\n",(0,a.jsx)(n.li,{children:"The container image must implement the Lambda Runtime API"}),"\n",(0,a.jsx)(n.li,{children:"ECS / Fargate is preferred for running arbitrary Docker images"}),"\n"]}),"\n",(0,a.jsx)(n.h1,{id:"aws-lambda-pricing",children:"AWS Lambda Pricing"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Pay per calls:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"First 1,000,000 requests are free"}),"\n",(0,a.jsx)(n.li,{children:"$0.20 per | million requests thereafter ($0.0000002 per request)"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Pay per duration: (in increment of 1 ms)","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"400,000 GB-seconds of compute time per month if FREE"}),"\n",(0,a.jsx)(n.li,{children:"== 400,000 seconds if function is IGB RAM\n-== 3,200,000 seconds if function is 128 MB RAM"}),"\n",(0,a.jsx)(n.li,{children:"After that $1.00 for 600,000 GB-seconds"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"It is usually very cheap to run AWS Lambda so it's very popular"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"aws-lambda-integrations-main-services",children:"AWS Lambda Integrations Main Services"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img.png",src:i(83627).A+"",width:"1262",height:"521"})}),"\n",(0,a.jsx)(n.h2,{id:"example-serverless-thumbnail-generation",children:"Example: Serverless Thumbnail Generation"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img.png",src:i(54030).A+"",width:"1279",height:"583"})}),"\n",(0,a.jsx)(n.h2,{id:"example-serverless-cron-job",children:"Example: Serverless CRON Job"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img.png",src:i(81861).A+"",width:"757",height:"289"})}),"\n",(0,a.jsx)(n.h2,{id:"lambda-concurrency-and-throttling",children:"Lambda Concurrency and Throttling"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Concurrency limit: up to 1000 concurrent executions\n",(0,a.jsx)(n.img,{alt:"img.png",src:i(58371).A+"",width:"1028",height:"201"})]}),"\n",(0,a.jsx)(n.li,{children:"Can set a \u201creserved concurrency\u201d at the function level (=limit)"}),"\n",(0,a.jsx)(n.li,{children:"Each invocation over the concurrency limit will trigger a \u201cThrottle\u201d"}),"\n",(0,a.jsx)(n.li,{children:"Throttle behavior:"}),"\n",(0,a.jsx)(n.li,{children:"If synchronous invocation => return ThrottleError - 429"}),"\n",(0,a.jsx)(n.li,{children:"If asynchronous invocation => retry automatically and then go to DLQ"}),"\n",(0,a.jsx)(n.li,{children:"If you need a higher limit, open a support ticket"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"lambda-concurrency-issue",children:"Lambda Concurrency Issue"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img.png",src:i(90137).A+"",width:"1266",height:"584"})}),"\n",(0,a.jsx)(n.h2,{id:"concurrency-and-asynchronous-invocations",children:"Concurrency and Asynchronous Invocations"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"If the function doesn't have enough concurrency available to process all events, additional requests are throttled."}),"\n",(0,a.jsx)(n.li,{children:"For throttling errors (429) and system errors (500-series), Lambda returns the event to the queue and attempts to run the function again for up to 6 hours."}),"\n",(0,a.jsxs)(n.li,{children:["The retry interval increases exponentially from 1 second after the first attempt to a maximum of 5 minutes.\n",(0,a.jsx)(n.img,{alt:"img.png",src:i(41967).A+"",width:"588",height:"508"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"cold-starts--provisioned-concurrency",children:"Cold Starts & Provisioned Concurrency"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Cold Start:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"New instance => code is loaded and code outside the handler run (init)"}),"\n",(0,a.jsx)(n.li,{children:"If the init is large (code, dependencies, SDK\u2026) this process can take some time."}),"\n",(0,a.jsx)(n.li,{children:"First request served by new instances has higher latency than the rest"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Provisioned Concurrency:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Concurrency is allocated before the function is invoked (in advance)"}),"\n",(0,a.jsx)(n.li,{children:"So the cold start never happens and all invocations have low latency"}),"\n",(0,a.jsx)(n.li,{children:"Application Auto Scaling can manage concurrency (schedule or target utilization)"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["Note:","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Note: cold starts in VPC have been dramatically reduced in Oct & Nov 2019"}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://aws.amazon.com/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/",children:"https://aws.amazon.com/blogs/compute/announcing-improved-vpc-networking-for-aws-lambda-functions/"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"reserved-and-provisioned-concurrency",children:"Reserved and Provisioned Concurrency"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"img.png",src:i(46514).A+"",width:"1279",height:"595"})}),"\n",(0,a.jsx)(n.h2,{id:"lambda-snapstart",children:"Lambda SnapStart"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Improves your Lambda functions performance up to 10x at no extra cost for Java, Python & .NET"}),"\n",(0,a.jsx)(n.li,{children:"When enabled, function is invoked from a pre- initialized state (no function initialization from scratch)"}),"\n",(0,a.jsx)(n.li,{children:"When you publish a new version:"}),"\n",(0,a.jsx)(n.li,{children:"Lambda initializes your function"}),"\n",(0,a.jsx)(n.li,{children:"Takes a snapshot of memory and disk state of the initialized function"}),"\n",(0,a.jsxs)(n.li,{children:["Snapshot is cached for low-latency access\n",(0,a.jsx)(n.img,{alt:"img.png",src:i(30974).A+"",width:"403",height:"642"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"customization-at-the-edge",children:"Customization At The Edge"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Many modern applications execute some form of the logic at the edge"}),"\n",(0,a.jsx)(n.li,{children:"Edge Function:"}),"\n",(0,a.jsx)(n.li,{children:"A code that you write and attach to CloudFront distributions"}),"\n",(0,a.jsx)(n.li,{children:"Runs close to your users to minimize latency"}),"\n",(0,a.jsx)(n.li,{children:"CloudFront provides two types: CloudFront Functions & Lambda@Edge"}),"\n",(0,a.jsx)(n.li,{children:"You don\u2019t have to manage any servers, deployed globally"}),"\n",(0,a.jsx)(n.li,{children:"Use case: customize the CDN content"}),"\n",(0,a.jsx)(n.li,{children:"Pay only for what you use"}),"\n",(0,a.jsx)(n.li,{children:"Fully serverless"}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"cloudfront-functions--lambdaedge-use-cases",children:"CloudFront Functions & Lambda@Edge Use Cases"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Website Security and Privacy"}),"\n",(0,a.jsx)(n.li,{children:"Dynamic Web Application at the Edge"}),"\n",(0,a.jsx)(n.li,{children:"Search Engine Optimization (SEO)"}),"\n",(0,a.jsx)(n.li,{children:"Intelligently Route Across Origins and Data Centers"}),"\n",(0,a.jsx)(n.li,{children:"Bot Mitigation at the Edge"}),"\n",(0,a.jsx)(n.li,{children:"Real-time Image Transformation"}),"\n",(0,a.jsx)(n.li,{children:"A/B Testing"}),"\n",(0,a.jsx)(n.li,{children:"User Authentication and Authorization"}),"\n",(0,a.jsx)(n.li,{children:"User Prioritization"}),"\n",(0,a.jsx)(n.li,{children:"User Tracking and Analytics"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"lambda-by-default",children:"Lambda by default"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"By default, your Lambda function is launched outside your own VPC (in an AWS-owned VPC)"}),"\n",(0,a.jsxs)(n.li,{children:["Therefore, it cannot access resources in your VPC (RDS, ElastiCache, internal ELB\u2026)\n",(0,a.jsx)(n.img,{alt:"img.png",src:i(61681).A+"",width:"610",height:"575"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"lambda-in-vpc",children:"Lambda in VPC"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"You must define the VPC ID, the Subnets and the Security Groups"}),"\n",(0,a.jsxs)(n.li,{children:["Lambda will create an ENI (Elastic Network Interface) in your subnets\n",(0,a.jsx)(n.img,{alt:"img.png",src:i(80459).A+"",width:"573",height:"698"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"lambda-with-rds-proxy",children:"Lambda with RDS Proxy"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"If Lambda functions directly access your database, they may open too many connections under high load"}),"\n",(0,a.jsxs)(n.li,{children:["RDS Proxy","\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Improve scalability by pooling and sharing DB connections"}),"\n",(0,a.jsx)(n.li,{children:"Improve availability by reducing by 66% the failover time and preserving connections"}),"\n",(0,a.jsx)(n.li,{children:"Improve security by enforcing IAM authentication and storing credentials in Secrets Manager"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["The Lambda function must be deployed in your VPC, because RDS Proxy is never publicly accessible\n",(0,a.jsx)(n.img,{alt:"img.png",src:i(34355).A+"",width:"490",height:"658"})]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"invoking-lambda-from-rds--aurora",children:"Invoking Lambda from RDS & Aurora"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Invoke Lambda functions from within your DB instance"}),"\n",(0,a.jsx)(n.li,{children:"Allows you to process data events from within a database"}),"\n",(0,a.jsx)(n.li,{children:"Supported for RDS for PostgreSQL and Aurora MySQL"}),"\n",(0,a.jsx)(n.li,{children:"Must allow outbound traffic to your Lambda function from within your DB instance (Public, NAT GW, VPC Endpoints)"}),"\n",(0,a.jsxs)(n.li,{children:["DB instance must have the required permissions to invoke the Lambda function (Lambda Resource-based Policy & IAM Policy)\n",(0,a.jsx)(n.img,{alt:"img.png",src:i(4900).A+"",width:"394",height:"637"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},83627:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/Integrate-Lambda-c77f3ef2e7881bdaaabb36bd086ed682.png"},4900:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/RDS-Aurora-Lambda-4d41e3a18472285c6c5e08e3999519af.png"},54030:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/arch-1-2dbc44ec78090a503c931f6ba868b016.png"},81861:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/arch-2-60073509a53e8318208fc69da465f4f0.png"},41967:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/async-invocation-b3ed6bcc0e42b9102f101c005250804f.png"},90137:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/concurrency-issue-b4a14f2920555b03ece372055186fa77.png"},58371:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/concurrency-b2aae16246cf93be0207a27e6f554976.png"},34355:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/lambda-RDS-ce56b19df80d400ae3f729fe9b0cbcd7.png"},80459:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/lambda-VPC-04c428d897a44607debe74e35341fd5d.png"},61681:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/lambda-default-16bc48116e5d91995d39ac3e36c46e65.png"},30974:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/lambda-snapstart-8f50e62f56a6dc70700f861faea02925.png"},46514:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/provisioned-concurrency-6b1efe45a1d24f372e788b3645d8a477.png"},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var s=i(96540);const a={},r=s.createContext(a);function t(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);