"use strict";(self.webpackChunkkirbee_website=self.webpackChunkkirbee_website||[]).push([[3510],{45535:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"AWS/Global Infrastruture/CloudFront","title":"CloudFront","description":"- Content Delivery Network (CDN)","source":"@site/docs/AWS/Global Infrastruture/CloudFront.md","sourceDirName":"AWS/Global Infrastruture","slug":"/AWS/Global Infrastruture/CloudFront","permalink":"/ja-JP/docs/AWS/Global Infrastruture/CloudFront","draft":false,"unlisted":false,"editUrl":"https://github.com/kirbeee/kirbeee/docs/AWS/Global Infrastruture/CloudFront.md","tags":[],"version":"current","lastUpdatedBy":"kirbeee","lastUpdatedAt":1749101562000,"frontMatter":{"title":"CloudFront"},"sidebar":"docs","previous":{"title":"Elastic Load Balancer & Auto Scaling Group","permalink":"/ja-JP/docs/AWS/ELB & ASG/Introduction"},"next":{"title":"Edge Location","permalink":"/ja-JP/docs/AWS/Global Infrastruture/EdgeLocation"}}');var t=i(74848),r=i(28453);const o={title:"CloudFront"},l="CloudFront Overview",d={},a=[{value:"S3 bucket",id:"s3-bucket",level:2},{value:"Custom Origin (HTTP)",id:"custom-origin-http",level:2},{value:"CloudFront:",id:"cloudfront",level:2},{value:"S3 Cross Region Replication:",id:"s3-cross-region-replication",level:2},{value:"ALB or EC2 as an origin",id:"alb-or-ec2-as-an-origin",level:2},{value:"CloudFront Geo Restriction",id:"cloudfront-geo-restriction",level:2},{value:"CloudFront - Pricing",id:"cloudfront---pricing",level:2},{value:"Cache Invalidations",id:"cache-invalidations",level:2},{value:"CloudFront Functions",id:"cloudfront-functions",level:2},{value:"Lambda@Edge",id:"lambdaedge",level:2},{value:"CloudFront Functions vs. Lambda@Edge",id:"cloudfront-functions-vs-lambdaedge",level:2},{value:"CloudFront Functions vs. Lambda@Edge - Use Cases",id:"cloudfront-functions-vs-lambdaedge---use-cases",level:2},{value:"CloudFront Functions",id:"cloudfront-functions-1",level:3},{value:"Lambda@Edge",id:"lambdaedge-1",level:3}];function c(e){const n={em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"cloudfront-overview",children:"CloudFront Overview"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Content Delivery Network (CDN)"}),"\n",(0,t.jsx)(n.li,{children:"Improves read performance, content is cached at the edge"}),"\n",(0,t.jsx)(n.li,{children:"Improves users experience"}),"\n",(0,t.jsx)(n.li,{children:"216 Point of Presence globally (edge locations)"}),"\n",(0,t.jsx)(n.li,{children:"DDoS protection (because worldwide), integration with Shield, AWS Web Application Firewall"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"origins",children:"Origins"}),"\n",(0,t.jsx)(n.h2,{id:"s3-bucket",children:"S3 bucket"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"For distributing files and caching them at the edge"}),"\n",(0,t.jsx)(n.li,{children:"Enhanced security with CloudFront Origin Access Control (OAC)"}),"\n",(0,t.jsx)(n.li,{children:"OAC is replacing Origin Access Identity (OAl)"}),"\n",(0,t.jsx)(n.li,{children:"CloudFront can be used as an ingress (to upload files to S3)"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"custom-origin-http",children:"Custom Origin (HTTP)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Application Load Balancer"}),"\n",(0,t.jsx)(n.li,{children:"EC2 instance"}),"\n",(0,t.jsx)(n.li,{children:"S3 website (must first enable the bucket as a static S3 website)"}),"\n",(0,t.jsx)(n.li,{children:"Any HTTP backend you want"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"cloudfront-at-a-high-level",children:"Cloudfront at a high level"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"CloudFront",src:i(62375).A+"",width:"3486",height:"1526"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Example:\n",(0,t.jsx)(n.img,{alt:"CloudFront",src:i(4042).A+"",width:"3042",height:"1670"})]}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"cloudfront-vs-s3-cross-region-replication",children:"Cloudfront vs. S3 Cross Region Replication"}),"\n",(0,t.jsx)(n.h2,{id:"cloudfront",children:"CloudFront:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Global Edge network"}),"\n",(0,t.jsx)(n.li,{children:"Files are cached for a TTL (maybe a day)"}),"\n",(0,t.jsx)(n.li,{children:"Great for static content that must be available everywhere"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"s3-cross-region-replication",children:"S3 Cross Region Replication:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Must be setup for each region you want replication to happen"}),"\n",(0,t.jsx)(n.li,{children:"Files are updated in near real-time"}),"\n",(0,t.jsx)(n.li,{children:"Read only"}),"\n",(0,t.jsx)(n.li,{children:"Great for dynamic content that needs to be available at low-latency in few"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"alb-or-ec2-as-an-origin",children:"ALB or EC2 as an origin"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img.png",src:i(18453).A+"",width:"1329",height:"592"})}),"\n",(0,t.jsx)(n.h2,{id:"cloudfront-geo-restriction",children:"CloudFront Geo Restriction"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You can restrict who can access your distribution"}),"\n",(0,t.jsx)(n.li,{children:"Allowlist: Allow your users to access your content only if they're in one of the countries on a list of approved countries."}),"\n",(0,t.jsx)(n.li,{children:"Blocklist: Prevent your users from accessing your content if they're in one of the countries on a list of banned countries."}),"\n",(0,t.jsx)(n.li,{children:"The \u201ccountry\u201d is determined using a 3rd party Geo-IP database"}),"\n",(0,t.jsx)(n.li,{children:"Use case: Copyright Laws to control access to content"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"cloudfront---pricing",children:"CloudFront - Pricing"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"CloudFront Edge locations are all around the world"}),"\n",(0,t.jsxs)(n.li,{children:["The cost of data out per edge location varies\n",(0,t.jsx)(n.img,{alt:"img.png",src:i(310).A+"",width:"1093",height:"426"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"cache-invalidations",children:"Cache Invalidations"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"In case you update the back-end origin, CloudFront doesn\u2019t know about it and will only get the refreshed content after the TTL has expired"}),"\n",(0,t.jsx)(n.li,{children:"However, you can force an entire or partial cache refresh (thus bypassing the TTL) by performing a CloudFront Invalidation"}),"\n",(0,t.jsxs)(n.li,{children:["You can invalidate all files (",(0,t.jsx)(n.em,{children:") or a special path (/images/"}),")\n",(0,t.jsx)(n.img,{alt:"img.png",src:i(11308).A+"",width:"648",height:"673"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"cloudfront-functions",children:"CloudFront Functions"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Lightweight functions written in JavaScript"}),"\n",(0,t.jsx)(n.li,{children:"For high-scale, latency-sensitive CDN customizations"}),"\n",(0,t.jsx)(n.li,{children:"Sub-ms startup times, millions of requests/second"}),"\n",(0,t.jsxs)(n.li,{children:["Used to change Viewer requests and responses:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Viewer Request: after CloudFront receives a request from a viewer"}),"\n",(0,t.jsx)(n.li,{children:"Viewer Response: before CloudFront forwards the response to the viewer"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Native feature of CloudFront (manage code entirely within CloudFront)\n",(0,t.jsx)(n.img,{alt:"img.png",src:i(24616).A+"",width:"308",height:"702"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"lambdaedge",children:"Lambda@Edge"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Lambda functions written in NodeJS or Python"}),"\n",(0,t.jsx)(n.li,{children:"Scales to 1000s of requests/second"}),"\n",(0,t.jsx)(n.li,{children:"Used to change CloudFront requests and responses:"}),"\n",(0,t.jsx)(n.li,{children:"Viewer Request \u2013 after CloudFront receives a request from a viewer"}),"\n",(0,t.jsx)(n.li,{children:"Origin Request \u2013 before CloudFront forwards the request to the origin"}),"\n",(0,t.jsx)(n.li,{children:"Origin Response \u2013 after CloudFront receives the response from the origin"}),"\n",(0,t.jsx)(n.li,{children:"Viewer Response \u2013 before CloudFront forwards the response to the viewer"}),"\n",(0,t.jsxs)(n.li,{children:["Author your functions in one AWS Region (us-east-1), then CloudFront replicates to its locations\n",(0,t.jsx)(n.img,{alt:"img.png",src:i(19361).A+"",width:"296",height:"671"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"cloudfront-functions-vs-lambdaedge",children:"CloudFront Functions vs. Lambda@Edge"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"img.png",src:i(81435).A+"",width:"1244",height:"554"})}),"\n",(0,t.jsx)(n.h2,{id:"cloudfront-functions-vs-lambdaedge---use-cases",children:"CloudFront Functions vs. Lambda@Edge - Use Cases"}),"\n",(0,t.jsx)(n.h3,{id:"cloudfront-functions-1",children:"CloudFront Functions"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Cache key normalization"}),"\n",(0,t.jsx)(n.li,{children:"Transform request attributes (headers, cookies, query strings, URL) to create an optimal Cache Key"}),"\n",(0,t.jsx)(n.li,{children:"Header manipulation"}),"\n",(0,t.jsx)(n.li,{children:"Insert/modify/delete HTTP headers in the request or response"}),"\n",(0,t.jsx)(n.li,{children:"URL rewrites or redirects"}),"\n",(0,t.jsx)(n.li,{children:"Request authentication & authorization"}),"\n",(0,t.jsx)(n.li,{children:"Create and validate user-generated tokens (e.g., JWT) to allow/deny requests"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"lambdaedge-1",children:"Lambda@Edge"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Longer execution time (several ms)"}),"\n",(0,t.jsx)(n.li,{children:"Adjustable CPU or memory"}),"\n",(0,t.jsx)(n.li,{children:"Your code depends on a 3rd libraries (e.g., AWS SDK to access other AWS services)"}),"\n",(0,t.jsx)(n.li,{children:"Network access to use external services for processing"}),"\n",(0,t.jsx)(n.li,{children:"File system access or access to the body of HTTP requests"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},18453:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/ALB-EC2-6892235b906fe26d5724a6827ecc8606.png"},4042:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/Cloudfront-example-42827c8bef16a125e2e8794cfa94b063.png"},62375:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/Cloudfront-high-level-8282512b4979b4dfaddc2dfef6f7e433.png"},11308:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/cache-invalidation-3b6571d9a5861f8d8b0a021bb629f9ae.png"},19361:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/cloudfront-edge-24bac1201f3bf01948e16e8c4edf1bba.png"},24616:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/cloudfront-func-f2bef8e813fcf4436f86cddeecb888af.png"},310:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/cloudfront-pricing-69b62dd284a9d439643a130926e97450.png"},81435:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/func-edge-34b0660041503bb59662ef91582a2591.png"},28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var s=i(96540);const t={},r=s.createContext(t);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);